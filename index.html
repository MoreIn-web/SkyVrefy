<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>
<style>
body{margin:0; font-family:'Arial', sans-serif; background:#111; color:#fff;}
table{width:100%; border-collapse:collapse;}
th,td{padding:10px; border:1px solid #0ff; text-align:left;}
button{padding:5px 10px; border:none; border-radius:6px; cursor:pointer; background:#1f6feb; color:#fff;}
button:hover{background:#0ff; color:#000;}
</style>
</head>
<body>
<h1>Admin Panel - Verify Users</h1>
<table>
<thead>
<tr><th>Number</th><th>Verified</th><th>Action</th></tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

<script type="module">
import { db, collection, onSnapshot, updateDoc, doc } from './firebase.js';

const tableBody = document.getElementById("tableBody");

// Listen for new verifications
onSnapshot(collection(db,"verifications"), (snapshot)=>{
  tableBody.innerHTML = "";
  snapshot.forEach(docSnap=>{
    const data = docSnap.data();
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${data.number}</td>
                    <td>${data.verified}</td>
                    <td>${data.verified ? "": `<button data-id="${docSnap.id}">Verify</button>`}</td>`;
    tableBody.appendChild(tr);
  });

  // Add click listener to verify buttons
  document.querySelectorAll("button[data-id]").forEach(btn=>{
    btn.onclick = async ()=>{
      const id = btn.getAttribute("data-id");
      await updateDoc(doc(db,"verifications",id),{verified:true});
      alert("User Verified!");
    }
  });
});
</script>
</body>
</html>
